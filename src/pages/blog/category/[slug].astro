---
import BlogCard from "@/components/blog/BlogCard.astro";
import ListLayout from "@/layouts/ListLayout.astro";
import { getArticles, getArticlesByCategorySlug } from "@/lib/strapi";
import type { GetStaticPaths } from "astro";

const { slug } = Astro.params;

const articles = await getArticlesByCategorySlug(slug);

const categoryName = articles[0]?.category?.name || slug;
const title = `Kategori: ${categoryName}`;
---

<ListLayout title={title}
  description={`Artikel dalam kategori ${categoryName}`}
  subtitle={`${articles.length} artikel tersedia`} 
  columns={3}
  showSearch={true}
  pageTitle="Berita & Artikel"
  emptyStateTitle="Belum ada artikel"
  emptyStateDescription="Artikel akan muncul di sini setelah dipublikasikan"
>
    {
      articles.map((article) => {
        return (
          <BlogCard
            cover={article.coverlink}
            title={article.title}
            description={article.description}
            category={article.category?.name}
            publishedAt={article.publishedAt}
            author={{
              name: article.author?.name,
              avatar: article.author?.avatar?.url,
            }}
            slug={article.slug}
          />
        );
      })
    }
</ListLayout>
