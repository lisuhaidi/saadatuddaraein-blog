---
import '../styles/global.css';
import Navbar from '@/components/layout/navbar';
import Footer from '@/components/layout/footer';
import { ViewTransitions } from 'astro:transitions';

import LoadingIndicator from "astro-loading-indicator/component"


import about from '@/data/about.json'
---

<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/floadavicon.svg" />
		<ViewTransitions />
		<LoadingIndicator color='#5EA500' threshold={false}/>
		<meta name="generator" content={Astro.generator} />
		<title>Saadatuddaraein</title>
		<script is:inline>
			/*
				1. Ambil theme dari localStorage jika ada.
				2. Kalau belum ada, pakai preferensi OS.
				3. Terapkan class "dark" SEBELUM render untuk menghindari flicker.
				4. Terapkan lagi setelah navigasi SPA (astro:after-swap).
			*/

			function applyTheme() {
				const saved = localStorage.getItem('theme');
				const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

				const theme = saved || (prefersDark ? 'dark' : 'light');

				document.documentElement.classList.toggle('dark', theme === 'dark');

				// hanya set jika belum ada (biar tidak menimpa preferensi user)
				if (!saved) localStorage.setItem('theme', theme);
			}

			// Jalankan sebelum halaman dirender (initial load)
			applyTheme();

			// Jalankan ulang SETIAP ada view transition (navigasi)
			document.addEventListener('astro:after-swap', () => {
				applyTheme();
			});
		</script>

	</head>
	<body>
		<Navbar title={about?.title || 'Saadatuddaraein'} client:load transition:persist/>
		<div class="flex min-h-[calc(100vh-10rem)] items-center justify-center">
   			<slot />
		</div>
		<Footer description={about?.description} telephone={about?.telephone} email={about?.email} address={about?.address} client:load/>

	</body>
</html>

<style>
	html,
	body {
		margin: 0;
		width: 100%;
		height: 100%;
	}
</style>
